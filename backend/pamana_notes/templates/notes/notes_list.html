{% extends "base.html" %}

{% block content %}
<h1 class="text-2xl font-bold mb-4">Notes</h1>

<!-- Search & Filter Form -->
<form id="notes-search-form" method="get" class="mb-4 flex gap-2">
    <input type="text" name="q" id="search-input" placeholder="Search notes..." value="{{ query }}" class="border rounded px-2 py-1 flex-grow">

    <select name="course" id="course-filter" class="border rounded px-2 py-1">
        <option value="">All Courses</option>
        {% for c in courses %}
            <option value="{{ c.id }}" {% if course_id|default:'' == c.id|stringformat:"s" %}selected{% endif %}>
                {{ c.name }}
            </option>
        {% endfor %}
    </select>

    <button type="submit" class="bg-blue-500 text-white px-4 py-1 rounded">
        Search
    </button>
</form>

<!-- Notes Grid -->
<div id="notes-grid">
    {% for note in page_obj %}
    <div class="note-card border p-4 rounded mb-4">
        <h2 class="text-xl font-bold">{{ note.title }}</h2>

        <p>{{ note.description }}</p>

        <p class="text-sm text-gray-500">
            Uploaded by: {{ note.uploader.school_id }}
        </p>
        <a href="{% url 'notes:note_detail' note.id %}" class="text-blue-700 underline">
            View Note
        </a>
    </div>
    {% empty %}
    <p>No notes found.</p>
    {% endfor %}
</div>

<!-- Pagination -->
<div id="notes-pagination" class="mt-4 flex justify-center gap-2">
    {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}{% if query %}&q={{ query }}{% endif %}"
           class="px-2 py-1 border rounded">
            Previous
        </a>
    {% endif %}

    <span class="px-2 py-1">
        {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
    </span>

    {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}{% if query %}&q={{ query }}{% endif %}"
           class="px-2 py-1 border rounded">
            Next
        </a>
    {% endif %}
</div>
{% endblock %}
